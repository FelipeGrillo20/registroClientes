<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Clientes Registrados</title>
  <link rel="stylesheet" href="css/clientes.css" />
</head>
<body>
  <header class="page-header">
    <div id="userInfo" class="user-info-bar"></div>
    <div class="header-title-container">
      <h1>ğŸ“‹ Trabajadores Registrados</h1>
      <!-- âœ… NUEVO: Contador de trabajadores al lado del tÃ­tulo -->
      <div id="contadorTrabajadores" class="contador-trabajadores" style="display: none;">
        <span class="contador-icon">ğŸ‘¥</span>
        <span class="contador-label">Cantidad Trabajadores:</span>
        <span class="contador-numero" id="cantidadTrabajadores">0</span>
      </div>
    </div>
  </header>

  <main class="page-main">
    <!-- Botones de acciÃ³n -->
    <div class="filter-actions">
      <!-- âœ… MOVIDO AL INICIO: BotÃ³n Formulario Registro -->
      <a href="index.html" class="btn-back-form">â† Formulario Registro</a>
      
      <button id="btnClearFilters" class="btn-clear-filters">ğŸ”„ Limpiar Filtros</button>
      
      <!-- Filtro de profesional (solo visible para admin) -->
      <div id="profesionalFilterContainer" class="profesional-filter-container" style="display: none;">
        <label for="filterProfesionalSelect" class="filter-label">ğŸ‘¤ Profesional:</label>
        <select id="filterProfesionalSelect" class="filter-profesional-select">
          <option value="">Todos los Profesionales</option>
        </select>
      </div>

      <!-- âœ… NUEVO: Badge de nombre para perfil profesional (en lugar del select) -->
      <div id="profesionalBadgeContainer" class="profesional-badge-container" style="display: none;">
        <div class="profesional-badge-card">
          <div class="profesional-badge-avatar" id="profesionalBadgeAvatar">ğŸ‘¤</div>
          <div class="profesional-badge-info">
            <span class="profesional-badge-label">Profesional</span>
            <span class="profesional-badge-nombre" id="profesionalBadgeNombre">-</span>
          </div>
          <div class="profesional-badge-dot"></div>
        </div>
      </div>
      
      <!-- Filtro de aÃ±o (visible para admin Y profesional) -->
      <div id="yearFilterContainer" class="year-filter-container" style="display: none;">
        <label for="filterAÃ±o" class="filter-label">ğŸ“… AÃ±o:</label>
        <select id="filterAÃ±o" class="filter-year-select">
          <option value="">Todos los AÃ±os</option>
        </select>
      </div>
      
      <!-- Filtro de mes (visible para admin Y profesional) -->
      <div id="mesFilterContainer" class="mes-filter-container" style="display: none;">
        <label for="filterMes" class="filter-label">ğŸ“† Mes:</label>
        <select id="filterMes" class="filter-mes-select">
          <option value="">Todos los Meses</option>
        </select>
      </div>
    </div>

    <div class="table-container">
      <table class="client-table" id="clientTable" aria-describedby="tabla-clientes">
        <thead>
          <tr>
            <!-- CÃ‰DULA CON FILTRO -->
            <th class="filterable" data-type="cedula">
              <span>CÃ©dula</span>
              <span class="filter-icon" aria-label="Filtrar por cÃ©dula" title="Filtrar por cÃ©dula">âš™ï¸</span>
              <div class="filter-menu" id="filterMenu-cedula">
                <label for="filterCedula">Buscar por cÃ©dula:</label>
                <input type="text" id="filterCedula" placeholder="Ingresa cÃ©dula..." />
              </div>
            </th>

            <th>Nombre</th>

            <!-- SEDE CON FILTRO -->
            <th class="filterable" data-type="sede">
              <span>Sede</span>
              <span class="filter-icon" aria-label="Filtrar por sede" title="Filtrar por sede">âš™ï¸</span>
              <div class="filter-menu" id="filterMenu-sede">
                <label for="filterSede">Filtrar por sede:</label>
                <select id="filterSede">
                  <option value="">Todas las Sedes</option>
                </select>
              </div>
            </th>

            <th>Email</th>
            <th>TelÃ©fono</th>

            <!-- VÃNCULO CON FILTRO -->
            <th class="filterable" data-type="vinculo">
              <span>VÃ­nculo</span>
              <span class="filter-icon" aria-label="Filtrar por vÃ­nculo" title="Filtrar por vÃ­nculo">âš™ï¸</span>
              <div class="filter-menu" id="filterMenu-vinculo">
                <label for="filterVinculo">Filtrar por vÃ­nculo:</label>
                <select id="filterVinculo">
                  <option value="">Todos los VÃ­nculos</option>
                  <option value="Trabajador">Trabajador</option>
                  <option value="Familiar Trabajador">Familiar Trabajador</option>
                </select>
              </div>
            </th>

            <!-- EMPRESA USUARIO CON FILTRO -->
            <th class="filterable" data-type="empresa">
              <span>Empresa</span>
              <span class="filter-icon" aria-label="Filtrar por empresa" title="Filtrar por empresa">âš™ï¸</span>
              <div class="filter-menu" id="filterMenu-empresa">
                <label for="filterEmpresa">Filtrar por empresa:</label>
                <select id="filterEmpresa">
                  <option value="">Todas las Empresas</option>
                </select>
              </div>
            </th>

            <th>Acciones</th>
          </tr>
        </thead>

        <tbody id="clientList">
          <!-- Filas generadas dinÃ¡micamente -->
        </tbody>
      </table>
    </div>

    <!-- Mensaje inicial cuando no hay clientes -->
    <p id="noFilterMessage" class="no-filter-message">
      ğŸ” Usa los filtros para ver los clientes registrados.
    </p>
  </main>

  <!-- âœ… Scripts en el orden correcto -->
  <script src="js/config.js"></script>
  <script src="js/auth-check.js"></script>
  <!-- âœ… NUEVO: Scripts de generaciÃ³n de informes (se cargarÃ¡n dinÃ¡micamente cuando se necesiten) -->
  <script src="js/clientes.js"></script>
</body>
</html>